# Copyright 2022 ETH Zurich and University of Bologna.
# Licensed under the Apache License, Version 2.0, see LICENSE for details.
# SPDX-License-Identifier: Apache-2.0

# Author: Paul Scheffler <paulsc@iis.ee.ethz.ch>

name: gitlab-ci

on:
  push:
    branches: [ main, ci ]
  delete:
    branches: [ main, ci ]

jobs:
  gitlab-ci:
    runs-on: ubuntu-latest
    steps:
    -
      name: Full checkout
      run: git clone --bare https://token:${{ github.token }}@github.com/${{ github.repository }} ${{ github.workspace }}
    -
      name: Push to mirror
      run: |
        git remote add gitlab https://token:${{ secrets.GITLAB_TOKEN }}@iis-git.ee.ethz.ch/github-mirror/cheshire.git
        git push --force --mirror gitlab
