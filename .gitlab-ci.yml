# Copyright 2022 ETH Zurich and University of Bologna.
# Solderpad Hardware License, Version 0.51, see LICENSE for details.
# SPDX-License-Identifier: SHL-0.51

# Author: Thomas Benz <tbenz@iis.ee.ethz.ch>

variables:
  SPHINXBUILD: "/home/tbenz/.local/bin/sphinx-build"
  MORTY: "/home/tbenz/.cargo/bin/morty"

before_script:
  - source ~paulsc/.bashrc

stages:
  - prepare-non-free
  - iDMA

############# Below: only works on IIS machines ####################

prepare-non-free:
  stage: prepare-non-free
  script:
    - make nonfree
    - cd nonfree
    - make -B gen_sub_ci
  artifacts:
      paths:
        - nonfree/ci/*.yml


# Below: Automatically generated by util/gen_ci.py

cheshire_soc:
  stage: cheshire
  needs:
    - prepare-non-free
  trigger:
    include:
      - artifact: nonfree/ci/gitlab-cheshire-soc-ci.yml
        job: prepare-non-free
    strategy: depend


